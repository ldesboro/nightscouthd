<html>
<head>
    <title>iisnode logs</title>
    <style type="text/css">
        body
        {
            font-family: "Trebuchet MS" , Arial, Helvetica, sans-serif;
        }
        table
        {
            border-collapse: collapse;
        }
        td, th
        {
            border: 1px solid lightgray;
            padding: 3px 7px 2px 7px;
        }
        th
        {
            text-align: left;
            padding-top: 5px;
            padding-bottom: 4px;
            background-color: Gray;
            color: #ffffff;
        }
        td.stderr
        {
            color: Red;
        }
    </style>
</head>
<body>
    <table id="logFilesTable">
        <tr>
            <th>
                Computer name
            </th>
            <th>
                PID
            </th>
            <th>
                Type
            </th>
            <th>
                Created
            </th>
            <th>
                Link
            </th>
        </tr>
    </table>
    <p id="lastUpdated"></p>
    <script type="text/javascript">

        // this is replaced with actual data at runtime by code in interceptor.js
        var logFiles = [{"file":"OFFICE-1852-stderr-1381892819609.txt","computername":"OFFICE","pid":1852,"type":"stderr","created":1381892819609},{"file":"OFFICE-1928-stderr-1381892833259.txt","computername":"OFFICE","pid":1928,"type":"stderr","created":1381892833259},{"file":"OFFICE-2032-stderr-1381892824990.txt","computername":"OFFICE","pid":2032,"type":"stderr","created":1381892824990},{"file":"OFFICE-2032-stderr-1381892934130.txt","computername":"OFFICE","pid":2032,"type":"stderr","created":1381892934130},{"file":"OFFICE-2032-stdout-1381892934112.txt","computername":"OFFICE","pid":2032,"type":"stdout","created":1381892934112},{"file":"OFFICE-2312-stdout-1381891361437.txt","computername":"OFFICE","pid":2312,"type":"stdout","created":1381891361437},{"file":"OFFICE-2476-stderr-1381890806559.txt","computername":"OFFICE","pid":2476,"type":"stderr","created":1381890806559},{"file":"OFFICE-2476-stdout-1381890806553.txt","computername":"OFFICE","pid":2476,"type":"stdout","created":1381890806553},{"file":"OFFICE-2788-stdout-1381895480576.txt","computername":"OFFICE","pid":2788,"type":"stdout","created":1381895480576},{"file":"OFFICE-2888-stderr-1381888722939.txt","computername":"OFFICE","pid":2888,"type":"stderr","created":1381888722939},{"file":"OFFICE-2888-stdout-1381888722933.txt","computername":"OFFICE","pid":2888,"type":"stdout","created":1381888722933},{"file":"OFFICE-3660-stderr-1381891240474.txt","computername":"OFFICE","pid":3660,"type":"stderr","created":1381891240474},{"file":"OFFICE-3660-stdout-1381891240467.txt","computername":"OFFICE","pid":3660,"type":"stdout","created":1381891240467},{"file":"OFFICE-3856-stderr-1381884857996.txt","computername":"OFFICE","pid":3856,"type":"stderr","created":1381884857996},{"file":"OFFICE-3856-stdout-1381884857671.txt","computername":"OFFICE","pid":3856,"type":"stdout","created":1381884857671},{"file":"OFFICE-4612-stderr-1381892831492.txt","computername":"OFFICE","pid":4612,"type":"stderr","created":1381892831492},{"file":"OFFICE-4908-stderr-1381891367835.txt","computername":"OFFICE","pid":4908,"type":"stderr","created":1381891367835},{"file":"OFFICE-4908-stdout-1381891367825.txt","computername":"OFFICE","pid":4908,"type":"stdout","created":1381891367825},{"file":"OFFICE-5268-stderr-1381890998409.txt","computername":"OFFICE","pid":5268,"type":"stderr","created":1381890998409},{"file":"OFFICE-5268-stdout-1381890998401.txt","computername":"OFFICE","pid":5268,"type":"stdout","created":1381890998401},{"file":"OFFICE-5528-stderr-1381892847482.txt","computername":"OFFICE","pid":5528,"type":"stderr","created":1381892847482},{"file":"OFFICE-5528-stdout-1381892847460.txt","computername":"OFFICE","pid":5528,"type":"stdout","created":1381892847460},{"file":"OFFICE-5664-stderr-1381891300961.txt","computername":"OFFICE","pid":5664,"type":"stderr","created":1381891300961},{"file":"OFFICE-5664-stdout-1381891300953.txt","computername":"OFFICE","pid":5664,"type":"stdout","created":1381891300953},{"file":"OFFICE-6104-stderr-1381892824497.txt","computername":"OFFICE","pid":6104,"type":"stderr","created":1381892824497},{"file":"OFFICE-6260-stderr-1381889747553.txt","computername":"OFFICE","pid":6260,"type":"stderr","created":1381889747553},{"file":"OFFICE-6260-stdout-1381889747545.txt","computername":"OFFICE","pid":6260,"type":"stdout","created":1381889747545},{"file":"OFFICE-6320-stderr-1381892832503.txt","computername":"OFFICE","pid":6320,"type":"stderr","created":1381892832503},{"file":"OFFICE-6528-stderr-1381888783538.txt","computername":"OFFICE","pid":6528,"type":"stderr","created":1381888783538},{"file":"OFFICE-6528-stdout-1381888783532.txt","computername":"OFFICE","pid":6528,"type":"stdout","created":1381888783532},{"file":"OFFICE-660-stderr-1381891119425.txt","computername":"OFFICE","pid":660,"type":"stderr","created":1381891119425},{"file":"OFFICE-660-stdout-1381891119412.txt","computername":"OFFICE","pid":660,"type":"stdout","created":1381891119412},{"file":"OFFICE-6628-stderr-1381890867120.txt","computername":"OFFICE","pid":6628,"type":"stderr","created":1381890867120},{"file":"OFFICE-6628-stdout-1381890867111.txt","computername":"OFFICE","pid":6628,"type":"stdout","created":1381890867111},{"file":"OFFICE-6636-stderr-1381892818540.txt","computername":"OFFICE","pid":6636,"type":"stderr","created":1381892818540},{"file":"OFFICE-6776-stderr-1381891179956.txt","computername":"OFFICE","pid":6776,"type":"stderr","created":1381891179956},{"file":"OFFICE-6776-stdout-1381891179948.txt","computername":"OFFICE","pid":6776,"type":"stdout","created":1381891179948},{"file":"OFFICE-6804-stderr-1381891058894.txt","computername":"OFFICE","pid":6804,"type":"stderr","created":1381891058894},{"file":"OFFICE-6804-stdout-1381891058888.txt","computername":"OFFICE","pid":6804,"type":"stdout","created":1381891058888},{"file":"OFFICE-6808-stderr-1381889687099.txt","computername":"OFFICE","pid":6808,"type":"stderr","created":1381889687099},{"file":"OFFICE-6808-stderr-1381892825248.txt","computername":"OFFICE","pid":6808,"type":"stderr","created":1381892825248},{"file":"OFFICE-6808-stdout-1381889687091.txt","computername":"OFFICE","pid":6808,"type":"stdout","created":1381889687091},{"file":"OFFICE-6936-stderr-1381892821289.txt","computername":"OFFICE","pid":6936,"type":"stderr","created":1381892821289},{"file":"OFFICE-7016-stdout-1381891559474.txt","computername":"OFFICE","pid":7016,"type":"stdout","created":1381891559474},{"file":"OFFICE-7024-stdout-1381890537993.txt","computername":"OFFICE","pid":7024,"type":"stdout","created":1381890537993},{"file":"OFFICE-7096-stdout-1381890682202.txt","computername":"OFFICE","pid":7096,"type":"stdout","created":1381890682202},{"file":"OFFICE-7132-stdout-1381891363492.txt","computername":"OFFICE","pid":7132,"type":"stdout","created":1381891363492},{"file":"OFFICE-7436-stderr-1381892820555.txt","computername":"OFFICE","pid":7436,"type":"stderr","created":1381892820555},{"file":"OFFICE-7608-stderr-1381892833001.txt","computername":"OFFICE","pid":7608,"type":"stderr","created":1381892833001},{"file":"OFFICE-7804-stderr-1381892823489.txt","computername":"OFFICE","pid":7804,"type":"stderr","created":1381892823489},{"file":"OFFICE-7852-stderr-1381892820758.txt","computername":"OFFICE","pid":7852,"type":"stderr","created":1381892820758},{"file":"OFFICE-7896-stderr-1381892832733.txt","computername":"OFFICE","pid":7896,"type":"stderr","created":1381892832733},{"file":"OFFICE-7932-stderr-1381892821014.txt","computername":"OFFICE","pid":7932,"type":"stderr","created":1381892821014},{"file":"OFFICE-7948-stderr-1381892824732.txt","computername":"OFFICE","pid":7948,"type":"stderr","created":1381892824732},{"file":"OFFICE-8776-stdout-1381895642601.txt","computername":"OFFICE","pid":8776,"type":"stdout","created":1381895642601},{"file":"OFFICE-8936-stdout-1381895442607.txt","computername":"OFFICE","pid":8936,"type":"stdout","created":1381895442607},{"file":"OFFICE-8976-stdout-1381894566984.txt","computername":"OFFICE","pid":8976,"type":"stdout","created":1381894566984}];
        var lastUpdated = 1381895642671;
        var date = new Date();

        date.setTime(lastUpdated);
        document.getElementById('lastUpdated').innerHTML = 'Index was last updated ' + date;

        logFiles.sort(function (a, b) {
            return b.created - a.created;
        });

        var logFilesTable = document.getElementById("logFilesTable");
        for (var i = 0; i < logFiles.length; i++) {
            var logFile = logFiles[i];
            date.setTime(logFile.created);
            var row = logFilesTable.insertRow(-1);
            var computerNameCell = row.insertCell(0);
            var pidCell = row.insertCell(1);
            var typeCell = row.insertCell(2);
            var dateCell = row.insertCell(3);
            var logCell = row.insertCell(4);
            computerNameCell.innerHTML = logFile.computername;
            pidCell.innerHTML = logFile.pid.toString();
            typeCell.innerHTML = logFile.type;
            typeCell.setAttribute('class', logFile.type);
            dateCell.innerHTML = date.toString();
            logCell.innerHTML = '<a href="' + logFile.file + '">log</a>';
        };

    </script>
</body>
</html>
